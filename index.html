<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>选择正确的颜色!</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            text-align: center;
            background: #f0f4f8;
            padding: 30px;
        }
        h1 {
            color: #333;
        }
        #level, #timer {
            font-size: 20px;
            margin: 10px;
        }
        #targetColor {
            font-weight: bold;
            font-size: 24px;
            margin: 20px;
        }
        #board {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            max-width: 600px; /* Có thể tăng max-width nếu số nút quá nhiều */
            margin-left: auto;
            margin-right: auto;
        }
        .color-btn {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            cursor: pointer;
            border: 3px solid transparent;
            transition: 0.3s;
        }
        .color-btn:hover {
            transform: scale(1.05);
            border-color: #555;
        }
        #message {
            margin-top: 20px;
            font-size: 22px;
            color: #008000;
        }
        #startBtn {
            padding: 10px 20px;
            font-size: 18px;
            margin-top: 20px;
            background-color: #2c89e8;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }
        #startBtn:hover {
            background-color: #1e70c1;
        }
    </style>
</head>
<body>

    <h1>🎯 在10秒内选对颜色！</h1>
    <div id="level">级别: 1</div>
    <div id="timer">时间: 10s</div>
    <div>要选择的颜色:</div>
    <div id="targetColor">红色</div>
    <div id="board"></div>
    <div id="message"></div>
    <button id="startBtn">开始游戏</button>

    <script>
        // Bản đồ ánh xạ tên màu tiếng Trung với mã màu hợp lệ (Hex hoặc tên tiếng Anh)
        // Đã thêm nhiều màu hơn để tăng độ đa dạng
        const colorMap = {
            '红色': '#FF0000',      // Đỏ
            '绿色': '#008000',      // Xanh lá cây
            '蓝色': '#0000FF',      // Xanh dương
            '橙色': '#FFA500',      // Cam
            '紫色': '#800080',      // Tím
            '粉色': '#FFC0CB',      // Hồng
            '黄色': '#FFFF00',      // Vàng
            '青色': '#00FFFF',      // Xanh lam/Cyan
            '棕色': '#A52A2A',      // Nâu
            '灰色': '#808080',      // Xám
            '黑色': '#000000',      // Đen
            '白色': '#FFFFFF',      // Trắng
            '金色': '#FFD700',      // Vàng kim
            '银色': '#C0C0C0',      // Bạc
            '深蓝': '#00008B',      // Xanh đậm
            '深绿': '#006400',      // Xanh lá đậm
            '洋红': '#FF00FF',      // Magenta
            '薄荷绿': '#98FF98',    // Mint Green
            '琥珀色': '#FFBF00',    // Amber
            '石灰绿': '#32CD32'     // Lime Green
        };

        // Lấy danh sách tên màu tiếng Trung từ colorMap để dùng trong trò chơi
        const colors = Object.keys(colorMap); 

        // Cấu hình cấp độ: Tăng số lượng nút (count) và giảm thời gian (time)
        const levelSettings = [
            { count: 4, time: 10 },    // Cấp 1: 4 nút, 10s
            { count: 6, time: 9 },     // Cấp 2: 6 nút, 9s
            { count: 8, time: 8 },     // Cấp 3: 8 nút, 8s
            { count: 10, time: 7 },    // Cấp 4: 10 nút, 7s
            { count: 12, time: 6 },    // Cấp 5: 12 nút, 6s
            { count: 15, time: 6 },    // Cấp 6: 15 nút, 6s
            { count: 18, time: 5 },    // Cấp 7: 18 nút, 5s
            { count: 20, time: 5 },    // Cấp 8: 20 nút, 5s
            { count: 24, time: 4 },    // Cấp 9: 24 nút, 4s
            { count: 28, time: 4 },    // Cấp 10: 28 nút, 4s
            { count: 32, time: 3 }     // Cấp 11: 32 nút, 3s (rất khó)
            // Bạn có thể thêm hoặc điều chỉnh thêm cấp độ ở đây
        ];

        let currentLevel = 0;
        let correctColorName = ''; 
        let timeLeft = 10;
        let timer;
        let correctButtons = 0;

        const board = document.getElementById('board');
        const targetColorDisplay = document.getElementById('targetColor');
        const timerDisplay = document.getElementById('timer');
        const levelDisplay = document.getElementById('level');
        const message = document.getElementById('message');
        const startBtn = document.getElementById('startBtn');

        startBtn.onclick = startLevel;

        function startLevel() {
            if (currentLevel >= levelSettings.length) {
                message.textContent = '🎉 恭喜，你已经完成了所有级别！';
                startBtn.style.display = 'none';
                return;
            }

            // Reset
            board.innerHTML = '';
            message.textContent = '';
            startBtn.style.display = 'none';
            const level = levelSettings[currentLevel];

            correctColorName = colors[Math.floor(Math.random() * colors.length)];
            
            targetColorDisplay.textContent = correctColorName; 
            levelDisplay.textContent = `级别: ${currentLevel + 1}`;
            timeLeft = level.time;
            correctButtons = 0;

            let total = level.count;
            // Giữ số lượng màu đúng ở mức hợp lý, ví dụ 1/3 tổng số nút hoặc tối thiểu 2 nút đúng
            let correctCount = Math.max(2, Math.floor(total / 3)); 
            correctButtons = correctCount;

            let allColorNames = []; 

            // Thêm tên màu đúng
            for (let i = 0; i < correctCount; i++) {
                allColorNames.push(correctColorName);
            }

            // Thêm tên màu sai
            while (allColorNames.length < total) {
                let wrongColorName = colors[Math.floor(Math.random() * colors.length)];
                // Đảm bảo màu sai không trùng với màu đúng và có đủ màu khác nhau
                if (wrongColorName !== correctColorName && !allColorNames.includes(wrongColorName)) {
                    allColorNames.push(wrongColorName);
                }
                // Nếu không thể tìm màu sai khác, có thể thêm màu sai trùng nếu cần lấp đầy
                else if (!allColorNames.includes(wrongColorName)) { // Tránh lặp lại quá nhiều cùng 1 màu sai
                     allColorNames.push(wrongColorName);
                }
                 // Đảm bảo không bị mắc kẹt nếu số lượng màu trong colorMap ít hơn total
                 if (Object.keys(colorMap).length < total) {
                    // Nếu không đủ màu độc đáo, chấp nhận lặp lại màu sai
                    while (allColorNames.length < total) {
                        allColorNames.push(colors[Math.floor(Math.random() * colors.length)]);
                    }
                    break;
                }
            }

            // Trộn các tên màu
            allColorNames = allColorNames.sort(() => Math.random() - 0.5);

            // Tạo nút
            allColorNames.forEach(name => {
                const btn = document.createElement('button');
                btn.classList.add('color-btn');
                btn.style.backgroundColor = colorMap[name]; 
                btn.onclick = () => handleClick(btn, name); 
                board.appendChild(btn);
            });

            updateTimer();
            timer = setInterval(() => {
                timeLeft--;
                updateTimer();
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    gameOver(false);
                }
            }, 1000);
        }

        function handleClick(btn, clickedColorName) {
            if (clickedColorName === correctColorName) { 
                btn.disabled = true;
                btn.style.opacity = 0.3;
                correctButtons--;
                if (correctButtons === 0) {
                    clearInterval(timer);
                    gameOver(true);
                }
            } else {
                btn.style.borderColor = 'red';
                clearInterval(timer);
                gameOver(false);
            }
        }

        function gameOver(success) {
            if (success) {
                message.textContent = '✅ 恭喜你成功通过下一关！';
                message.style.color = 'green';
                currentLevel++;
            } else {
                message.textContent = '❌ 错误或时间到，按F5重新开始！';
                message.style.color = 'red';
            }
            startBtn.style.display = 'inline-block';
        }

        function updateTimer() {
            timerDisplay.textContent = `时间: ${timeLeft}s`;
        }
    </script>

</body>
</html>